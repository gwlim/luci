var map,layer_mapnik,layer_tah,layer_markers,PI=Math.PI,latfield="",lonfield="",latfield_id="",lonfield_id="",centerlon=10,centerlat=52,zoom=6;function lon2merc(a){return 2.003750834E7*a/180}function lat2merc(a){a=Math.log(Math.tan((90+a)*PI/360))/PI;return 2.003750834E7*a}function merc2lon(a){return 180*a/2.003750834E7}function merc2lat(a){return 360*Math.atan(Math.exp(a*PI/2.003750834E7))/PI-90}
OpenLayers.Control.Click=OpenLayers.Class(OpenLayers.Control,{defaultHandlerOptions:{single:!0,"double":!1,pixelTolerance:0,stopSingle:!1,stopDouble:!1},initialize:function(a){this.handlerOptions=OpenLayers.Util.extend({},this.defaultHandlerOptions);OpenLayers.Control.prototype.initialize.apply(this,arguments);this.handler=new OpenLayers.Handler.Click(this,{click:this.trigger},this.handlerOptions)},trigger:function(a){a=map.getLonLatFromViewPortPx(a.xy);lat=merc2lat(a.lat);lon=merc2lon(a.lon);latfield=
null==parent.document.getElementById(latfield_id)?document.getElementById("osmlat"):parent.document.getElementById(latfield_id);lonfield=null==parent.document.getElementById(lonfield_id)?document.getElementById("osmlon"):parent.document.getElementById(lonfield_id);latfield.value=lat;lonfield.value=lon}});
function init(){var a=window.name.substring(0,window.name.lastIndexOf("."));null!=parent.document.getElementById(a+".latfield")&&(latfield_id=parent.document.getElementById(a+".latfield").value,document.getElementById("osm").style.display="none");null!=parent.document.getElementById(a+".lonfield")&&(lonfield_id=parent.document.getElementById(a+".lonfield").value);null!=parent.document.getElementById(a+".centerlat")&&(centerlat=parseFloat(parent.document.getElementById(a+".centerlat").value));null!=
parent.document.getElementById(a+".centerlon")&&(centerlon=parseFloat(parent.document.getElementById(a+".centerlon").value));null!=parent.document.getElementById(a+".zoom")&&(zoom=parseFloat(parent.document.getElementById(a+".zoom").value))}
function drawmap(){OpenLayers.Lang.setCode("de");mapdiv=document.getElementById("map");mapdiv.style.height=window.innerHeight+"px";mapdiv.style.width=window.innerWidth+"px";map=new OpenLayers.Map("map",{projection:new OpenLayers.Projection("EPSG:900913"),displayProjection:new OpenLayers.Projection("EPSG:4326"),controls:[new OpenLayers.Control.Navigation,new OpenLayers.Control.PanZoomBar],maxExtent:new OpenLayers.Bounds(-2.003750834E7,-2.003750834E7,2.003750834E7,2.003750834E7),numZoomLevels:18,maxResolution:156543,
units:"meters"});layer_mapnik=new OpenLayers.Layer.OSM.Mapnik("Mapnik");map.addLayers([layer_mapnik]);var a=lat2merc(centerlat),b=lon2merc(centerlon);map.setCenter(new OpenLayers.LonLat(b,a),zoom);navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(a){var b=lat2merc(a.coords.latitude);a=lon2merc(a.coords.longitude);map.setCenter(new OpenLayers.LonLat(a,b),"17")});a=new OpenLayers.Control.Click;map.addControl(a);a.activate()};
